var workflow;(function(n){var i=function(){function n(n,t){n!=null&&n!=""&&t=="ToRead"&&($.pageLoading("show"),$.ajax({url:"../../Workflow/UpdateStateReadEnd",cache:!1,type:"GET",data:{taskUserId:n},success:function(n){$.pageLoading("hide");n.code==1&&alert(n.msg)},error:function(n){console.log(n.responseText);alert("待阅处理失败，请联系管理员");$.pageLoading("hide")}}))}return n}(),t;n.workFlowRead=i;t=function(){function n(t,i,r){switch(i){case"Done":case"ToRead":case"ReadEnd":n.HideTagFunc();n.ShowFlowHistory();break;case"ToDo":$.ajax({url:"../../Workflow/IsEnableFlowTab",cache:!1,type:"GET",data:{taskUserId:t,LinkCode:r},success:function(t){if(t.code==1){alert(t.msg);return}if(t.data){n.ShowFlowHistory();return}n.HideTagFunc()},error:function(n){console.log(n.responseText);alert("待阅处理失败，请联系管理员")}});break;default:n.HideFlowHistory()}}return n.HideTagFunc=function(){$("input,textarea,select").attr("disabled","disabled");$("button").hide();$("*[class*='notHide']").show();var n=$("[data-control]");n.find("input,span").css({cursor:"","background-color":"#eee"});n.find("span").unbind()},n.ShowTagFunc=function(){$("input,textarea,select").removeAttr("disabled");$("button").show()},n.ShowFlowHistory=function(){$("#flowHistoryBlock").show()},n.HideFlowHistory=function(){$("#flowHistoryBlock").hide()},n}();n.SetEnabled=t})(workflow||(workflow={}));$.fn.workflow=function(n){var i=$(this),t={mainCode:"",ParentId:"",expression:[],condition:"1",BillsCode:"",btnAuths:[],Primary:null,taskUserId:"",Type:null,load:null,setExpression:null,flowSubmit:null};return $.extend(t,n),t.Type=i.attr("data-type")||t.Type,t.mainCode=i.attr("data-maincode")||t.mainCode,t._btnBeforeCallback,t.btnBefore=function(n){return $.isFunction(n)&&(t._btnBeforeCallback=n),t},t._saveCallback,t.save=function(n){return $.isFunction(n)&&(t._saveCallback=n),t},t._closeCallback,t.close=function(n){return $.isFunction(n)&&(t._closeCallback=n),t},t._loadCallback,t.load=function(n){$.isFunction(n)&&(t._loadCallback=n);i.html("");var r="";return t.Type=="hisotry"?(r="../Workflow/FlowHistory.html",eval("workflowHisotry=_option;")):(r="../Workflow/FlowHandle.html",eval("workflowbtn=_option;")),i.load(r,null,function(n,t){t!="success"&&alert("Load Workflow组件失败，请联系管理员")}),t},t};$.fn.pagination=function(n){var o=$(this),u=o.find("ul"),t={pageSize:10,pageIndex:1,totalContent:0,loadCallback:null},f,i,r,e;$.extend(t,n);f=Math.ceil(t.totalContent/t.pageSize);u.html("");i=$('<li><a href="javascript:void(0);" aria-label="Previous"><span aria-hidden="true">&laquo;<\/span><\/a><\/li>');i.find("a").on("click",function(){t.pageIndex=1;t.loadCallback(t.pageIndex,t.pageSize)});for(u.append(i),r=1;r<=f;r++){e="";t.pageIndex==r&&(e='class="active"');i=$("<li "+e+'><a href="javascript:void(0);">'+r+"<\/a><\/li>");i.find("a").data("Data",{pageIndex:r});i.find("a").on("click",function(){var n=$(this).data("Data");t.pageIndex=n.pageIndex;t.loadCallback(t.pageIndex,t.pageSize)});u.append(i)}i=$('<li><a href="javascript:void(0);" aria-label="Next"><span aria-hidden="true">&raquo;<\/span><\/a><\/li>');i.find("a").on("click",function(){t.pageIndex=f;t.loadCallback(t.pageIndex,t.pageSize)});return u.append(i),t};